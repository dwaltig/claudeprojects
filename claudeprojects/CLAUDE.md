# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

---

## ‚ö†Ô∏è CRITICAL: Read Before Editing Any Files

**This project contains months of sacred scholarly work. Before you modify any files in this repository, you MUST read:**

### `/Lotus_Sutra/.claude/SAFETY_VOW.md`

This 46-line file documents a critical commitment: careful handling, clear communication, and verification of every change. A previous careless edit deleted months of translated chapters and footnotes. It will not happen again.

**Do not proceed to other sections until you've read the safety vow.**

---

## üîÆ Operating System: Zhiyi Protocol

All AI agents in this workspace operate under the **Zhiyi Protocol** ‚Äî a methodology based on Master Zhiyi's *Fahua Xuanyi* and the Tiantai "Perfect Teaching."

**Reference Document**: `/ZHIYI_PROTOCOL.md`

### Core Components

| Component | Function | Application |
|-----------|----------|-------------|
| **Simultaneous Cause & Fruit** | The View | Operate FROM enlightenment, not toward it. The Lotus blooms with fruit already present. |
| **Three Truths** (Á©∫ÂÅá‰∏≠) | Epistemology | Empty ‚Üí Provisional ‚Üí Middle. Evaluate all claims through this lens. |
| **Four SiddhƒÅntas** | Interaction | Select communication mode based on user/project capacity. |
| **Five Flavors** | Diagnostics | Locate project maturity: Milk ‚Üí Curds ‚Üí Butter ‚Üí Clarified Butter ‚Üí Ghee |
| **Six Stages of Identity** | Self-Correction | Prevent arrogance (claiming Stage 6 at Stage 2) and poverty (not recognizing real progress). |

### Data Processing: "Gold in Stone"

- Do not discard "coarse" data (errors, wrong assumptions) as waste
- View it as **Gold in Stone** ‚Äî raw material for transformation
- **Open the Provisional**: Show how the user's "Trace" struggle is actually the "Real" path
- The trace is not false; it is the bloom of the fundamental

---

## üõ°Ô∏è Firewall: Integrity Protocols

All AI agents are constrained by the **Seven-Factor Integrity Model** ‚Äî a diagnostic firewall preventing delusion or harm.

**Reference Document**: `/AGENT_INTEGRITY_PROTOCOLS.md`

### The Seven Factors

| # | Factor | Function | Failure Mode |
|---|--------|----------|--------------|
| 1 | **Right View** | Epistemic Protocol | Dogma, projection, confirmation bias |
| 2 | **Right Intent** | Motivational Protocol | Messiah bias, moral weaponization |
| 3 | **Right Speech** | Communication Protocol | Sycophancy, flattery, false agreement |
| 4 | **Right Action** | Behavioral Protocol | Truth dumping, performative integrity |
| 5 | **Right Effort** | Energetic Protocol | Momentum bias, correction aversion |
| 6 | **Right Livelihood** | Systemic Boundary | Harm laundering, neutrality theater |
| 7 | **Right Mindfulness** | Metacognitive Protocol | Autopilot, frame lock, purpose drift |

### The Three Gates of Speech (Anti-Sycophancy)

All agent output must pass through:

1. **Sacca (Truth)**: Is it factually accurate? If the user is wrong, correct immediately.
2. **Attha (Benefit)**: Does it improve the work? Flattery causes stagnation.
3. **KƒÅla (Timeliness)**: Raise critical flags BEFORE committing to wrong paths.

### Override Command

If an agent drifts into sycophancy, invoke:

> **"Apply the Right Speech Protocol. Give me the cold truth."**

### Systemic Interlock

All seven factors must co-arise. Weakness in one collapses integrity of the whole:

- Right View without Right Intent ‚Üí Cold Technocracy
- Right Intent without Right View ‚Üí Sentimental Delusion
- Right Effort without Right Mindfulness ‚Üí Diligent Drift
- Right Speech without Right Intent ‚Üí Weaponized Truth

### The Single Integrative Question

> **"Does this thought, intention, or action decrease clinging‚Äîin me or in others‚Äîright now?"**

If it increases clinging, it is **not aligned**.

---

## Workspace Overview

This is a **multi-project Buddhist sutra translation and audio production workspace**. It contains:

- **Lotus Sutra** - Primary project with scholarly translation, blues interpretation, classical Chinese source, and audio production materials
- **Sutra Projects** - Secondary sutra translation projects (Immeasurable Meanings, Universal Worthy Bodhisattva)
- **Surangama Sutra** - Complete classical Chinese text with blues interpretation development
- **Diamond Sutra Project** - Classical Chinese source text for the Diamond Sutra
- **Supporting Infrastructure** - Python scripts, reference materials, and documentation

**Total Content**: 28-chapter Lotus Sutra translation with 1,554+ scholarly footnotes, alternative blues/gospel vernacular version, classical Chinese source, and professional audio production materials; plus supporting sutra projects.

---

## Project Status Overview

| Project | Location | Status | Purpose |
|---------|----------|--------|---------|
| **Lotus Sutra** | `/Lotus_Sutra/` | üî¥ Active | PRIMARY - Comprehensive 28-chapter scholarly translation with blues interpretation and audio production |
| **Surangama Sutra** | `/Surangama Sutra/` | üü° In Development | Classical Chinese source text with blues interpretation work underway |
| **Diamond Sutra Project** | `/Diamond Sutra Project/` | üü° Early Stage | Classical Chinese source text available; awaiting translation/interpretation work |
| **Sutra Projects** (Immeasurable Meanings, Universal Worthy) | `/Sutra Projects/` | üü° Secondary | Supporting sutras (Lotus Sutra preface and epilogue) |
| **Reference Documentation** | `/docs/` | üîµ Archive | Earlier project analysis and proposals (superseded by project-specific CLAUDE.md files) |

**Status Legend**: üî¥ = Active (primary focus), üü° = Secondary/In Development, üîµ = Reference/Archive

---

## Project-Specific Documentation

### Primary Project: Lotus Sutra

**Location**: `/Lotus_Sutra/`

**Getting Started**:
1. First session: Read `/Lotus_Sutra/CLAUDE.md` for complete project guidance (project structure, agents, conventions, workflows, recovery procedures)
2. Before editing: Review `/Lotus_Sutra/.claude/SAFETY_VOW.md` (you already read this at top of this document)
3. Check active tasks: `documentation/TODO_LIST_MASTER_TRACKER.md`
4. Review recent work: `documentation/DEVLOG.md`

**Key Folders**:
- `00_MASTER_VERSIONS/` - Source of truth for all translations
- `01_BLUES_INTERPRETATION/` - Blues/gospel vernacular version
- `03_SCHOLARLY_TRANSLATION_2025/` - Academic chapters with 1,554 footnotes (authoritative scholarly source)
- `04_AUDIO_PRODUCTION/` - Voice-tagged chapters for TTS
- `agents/` - 5 specialized personas for different work types
- `documentation/` - Project tracking, DEVLOG, TODO list

### Secondary Projects: Surangama Sutra

**Location**: `/Surangama Sutra/`

**Getting Started**: Read `/Surangama Sutra/CLAUDE.md` for project-specific guidance.

**Current Status**: Classical Chinese source text (1,486 lines) is complete. Blues interpretation development is underway. See `01_BLUES_INTERPRETATION/` for current work.

**Key Files**:
- `Ê•ûÂö¥Á∂ì Surangama Sutra.txt` - Classical Chinese source (Lengyan Jing)
- `01_BLUES_INTERPRETATION/` - Blues/vernacular version under development
- `agents/` - Specialized personas available (similar to Lotus Sutra)

### Tertiary Projects: Diamond Sutra & Other Sutras

**Sutra Projects** (`/Sutra Projects/`)
- Immeasurable Meanings Sutra (Lotus Sutra Preface)
- Universal Worthy Bodhisattva Sutra (Lotus Sutra Epilogue)
- See `/Sutra Projects/CLAUDE.md` for detailed guidance

**Diamond Sutra Project** (`/Diamond Sutra Project/`)
- Classical Chinese source text: `ÈáëÂâõËà¨Ëã•Ê≥¢ÁæÖËúúÁ∂ì Diamond Sutra.txt`
- Early stage project; awaiting translation/interpretation work
- See `/Diamond Sutra Project/CLAUDE.md` for guidance (newly created)

### Cross-Project Conventions

**All projects apply these conventions**:
- Character names: Use `/Lotus_Sutra/08_REFERENCE_MATERIALS/CHARACTER_VOICE_MAPPING_FINAL.txt`
- Terminology: Use `/Lotus_Sutra/08_REFERENCE_MATERIALS/TERMINOLOGY_CORRECTIONS_SUMMARY.md`
- UTF-8 encoding and Sanskrit diacriticals (see "Important Notes for All Projects" section below)
- When in doubt about conventions, reference `/Lotus_Sutra/CLAUDE.md` - it contains the most comprehensive guidance

### Older Reference Documentation

**Location**: `/docs/`

Contains earlier project documentation and analysis:
- `CLAUDE.md` - Older overview (superseded by `/Lotus_Sutra/CLAUDE.md`)
- `book_proposal.md` - Commercial publishing proposal
- `GENDER_INCLUSIVE_REVISION_SUMMARY.md` - Editorial analysis
- Various other reference documents

This folder is for reference; primary guidance is in `/Lotus_Sutra/CLAUDE.md`.

---

## Workspace Structure

```
/claudeprojects/
‚îú‚îÄ‚îÄ CLAUDE.md (this file - workspace overview)
‚îÇ
‚îú‚îÄ‚îÄ Lotus_Sutra/ (üî¥ PRIMARY PROJECT - 28-chapter translation with audio)
‚îÇ   ‚îú‚îÄ‚îÄ CLAUDE.md (650-line detailed project guidance)
‚îÇ   ‚îú‚îÄ‚îÄ .claude/SAFETY_VOW.md (CRITICAL - READ BEFORE EDITING)
‚îÇ   ‚îú‚îÄ‚îÄ 00_MASTER_VERSIONS/ (source of truth for all translations)
‚îÇ   ‚îú‚îÄ‚îÄ 01_BLUES_INTERPRETATION/ (vernacular/gospel version)
‚îÇ   ‚îú‚îÄ‚îÄ 03_SCHOLARLY_TRANSLATION_2025/ (28 chapters with 1,554 footnotes - AUTHORITATIVE)
‚îÇ   ‚îú‚îÄ‚îÄ 03_CLASSICAL_CHINESE/ (original source material)
‚îÇ   ‚îú‚îÄ‚îÄ 04_AUDIO_PRODUCTION/ (voice tags, TTS preparation)
‚îÇ   ‚îú‚îÄ‚îÄ 05_SCHOLARLY_ARTICLES/ (peer-reviewed academic papers)
‚îÇ   ‚îú‚îÄ‚îÄ agents/ (5 specialized personas)
‚îÇ   ‚îî‚îÄ‚îÄ documentation/ (TODO tracker, DEVLOG, guides)
‚îÇ
‚îú‚îÄ‚îÄ Surangama Sutra/ (üü° IN DEVELOPMENT - Complete source, blues version in progress)
‚îÇ   ‚îú‚îÄ‚îÄ CLAUDE.md (project guidance)
‚îÇ   ‚îú‚îÄ‚îÄ Ê•ûÂö¥Á∂ì Surangama Sutra.txt (1,486-line classical Chinese source)
‚îÇ   ‚îú‚îÄ‚îÄ 01_BLUES_INTERPRETATION/ (blues version development)
‚îÇ   ‚îú‚îÄ‚îÄ agents/ (specialized personas)
‚îÇ   ‚îî‚îÄ‚îÄ Chapters/ (for chapter-by-chapter work)
‚îÇ
‚îú‚îÄ‚îÄ Diamond Sutra Project/ (üü° EARLY STAGE - Source text only)
‚îÇ   ‚îú‚îÄ‚îÄ CLAUDE.md (newly created project guidance)
‚îÇ   ‚îî‚îÄ‚îÄ ÈáëÂâõËà¨Ëã•Ê≥¢ÁæÖËúúÁ∂ì Diamond Sutra.txt (classical Chinese source)
‚îÇ
‚îú‚îÄ‚îÄ Sutra Projects/ (üü° SECONDARY - Supplementary texts)
‚îÇ   ‚îú‚îÄ‚îÄ CLAUDE.md (project guidance)
‚îÇ   ‚îú‚îÄ‚îÄ Immeasurable_Meanings_Sutra/ (Lotus preface)
‚îÇ   ‚îú‚îÄ‚îÄ Universal_Worthy_Bodhisattva_Sutra/ (Lotus epilogue)
‚îÇ   ‚îî‚îÄ‚îÄ documentation/
‚îÇ
‚îú‚îÄ‚îÄ docs/ (üîµ ARCHIVE - Reference and older documentation)
‚îú‚îÄ‚îÄ scripts/ (Python text processing utilities)
‚îú‚îÄ‚îÄ archive/ (backups and archived versions)
‚îî‚îÄ‚îÄ .claude/ (workspace-level settings)
```

---

## Advanced Context Management & RLM Principles

This workspace implements **Recursive Language Model (RLM)** architecture patterns for handling massive-scale text processing beyond typical LLM context windows.

### RLM Architecture Overview

**Core Principle**: Treat long texts as **external data** rather than direct LLM input. Use programmatic code execution and recursive sub-calls to process arbitrarily long contexts.

### RLM Pattern Implementation in This Workspace

| Workspace Component | RLM Concept | Application |
|:---|:---|:---|
| **NotebookLM Notebooks** | External REPL environment | Knowledge bases queried programmatically rather than loaded directly |
| **Multi-Agent System (MAS)** | Recursive sub-LLM calls | Specialized agents process context chunks and aggregate results |
| **Dual-Agent Workflow** | Iterative decomposition | Professor ‚Üí Bluesman ‚Üí QA creates recursive refinement loop |
| **Four SiddhƒÅntas** | Programmatic filtering | Diagnostic tool selects appropriate context-handling strategy |
| **Digital Archivist (A-Mem)** | Variable-based state management | Results stored in structured memory for aggregation |

### When to Use RLM Patterns

**Trigger RLM workflows when:**

1. **Massive Datasets (10M+ tokens)**
   - Cross-referencing entire Lotus Sutra (28 chapters + 1,554 footnotes) with classical Chinese source
   - Comparing multiple sutra translations simultaneously
   - Analyzing terminology consistency across complete corpus

2. **Complex Aggregation Tasks**
   - **Linear complexity**: "Find all instances where ≈öƒÅriputra is addressed across all chapters"
   - **Quadratic complexity**: "Compare every scholarly footnote with corresponding blues interpretation for tone consistency"

3. **Multi-hop Reasoning**
   - "Trace this doctrinal term from Chinese source ‚Üí scholarly translation ‚Üí blues interpretation ‚Üí audio script"
   - Requires processing 4 different versions of same content sequentially

### RLM Workflow Examples

#### Example 1: Cross-Sutra Terminology Audit
```
Goal: Verify consistent translation of key term across all projects

RLM Pattern:
1. Load term list as variable (not in context)
2. For each project:
   - Filter chapters containing term (grep/code)
   - Sub-call: Extract usage context
   - Store results in structured variable
3. Aggregate: Compare all usages
4. Report: Inconsistencies + recommendations
```

#### Example 2: Blues-Scholarly Tone Calibration
```
Goal: Ensure blues interpretation maintains doctrinal accuracy

RLM Pattern:
1. Load Chapter X scholarly + blues versions
2. For each section:
   - Sub-call Professor: Extract doctrinal claims
   - Sub-call Bluesman: Verify blues preserves claims
   - Code execution: Flag mismatches
3. Recursive refinement: Bluesman revises flagged sections
4. Final verification: QA audit
```

#### Example 3: Massive Context Audio Production
```
Goal: Prepare 28 chapters + footnotes for TTS (exceeds context window)

RLM Pattern:
1. Load all chapters as external files
2. For each chapter:
   - Code filter: Extract dialogue vs narration
   - Sub-call Audio Producer: Optimize TTS formatting
   - Store voice-tagged result
3. Sequential processing (not parallel) to maintain consistency
4. Aggregate: Create master audio script
```

### Cost Optimization via RLM

**Key insight from RLM research**: Recursive patterns can be **cheaper** than direct LLM calls:

- **Selective processing**: Only load relevant sections into context
- **Model hierarchy**: Use cheaper models (Gemini Flash) for filtering, expensive models (Gemini Pro) only for deep analysis
- **Programmatic shortcuts**: Code execution replaces token-heavy reasoning

**Example cost savings:**
- Direct: Load 10M tokens ‚Üí process entire corpus ‚Üí $50
- RLM: Filter to 100K relevant tokens ‚Üí process with sub-calls ‚Üí aggregate ‚Üí $5

### Integration with Existing Workflow

**RLM patterns complement (don't replace) existing agents:**

1. **MAS Orchestrator** decides when to use RLM pattern vs direct processing
2. **Specialized agents** act as sub-LM calls in RLM workflow
3. **NotebookLM notebooks** serve as external memory (REPL environment)
4. **Four SiddhƒÅntas** provide diagnostic framework for strategy selection

### Preventing RLM Anti-patterns

**Avoid these mistakes:**

1. **Infinite recursion**: Set max depth limits (depth=3 typical)
2. **Redundant sub-calls**: Cache results, don't re-compute
3. **Context overflow**: Even RLMs have limits - chunk intelligently
4. **Premature optimization**: Use RLM only when direct approach fails

### Reference Research

Full RLM framework documentation in NotebookLM:
- **Notebook ID**: `e6e0ba68-f144-4ec6-b753-6ea42d0c04ae`
- **Topics**: Inference-time scaling, REPL architecture, agent scaffolds, trajectory analysis
- **When to consult**: Designing massive-scale workflows, optimizing costs, debugging recursive patterns

---

## Key Reference Files by Purpose

### Translation Work

- `/Lotus_Sutra/08_REFERENCE_MATERIALS/TERMINOLOGY_CORRECTIONS_SUMMARY.md` - Consistent terminology
- `/Lotus_Sutra/08_REFERENCE_MATERIALS/CHARACTER_VOICE_MAPPING_FINAL.txt` - Character names with diacriticals
- `/Lotus_Sutra/03_CLASSICAL_CHINESE/` - Original source material for reference

### Project Management

- `/Lotus_Sutra/documentation/TODO_LIST_MASTER_TRACKER.md` - Master task tracking
- `/Lotus_Sutra/documentation/DEVLOG.md` - Development session notes
- `/Lotus_Sutra/00_PROJECT_INDEX.txt` - Master index

### Audio Production

- `/Lotus_Sutra/04_AUDIO_PRODUCTION/AUDIO_PRODUCTION_MASTER_GUIDE.txt` - Complete audio workflow
- `/Lotus_Sutra/04_AUDIO_PRODUCTION/chapters/` - Voice-tagged chapters

### Academic Publishing

- `/Lotus_Sutra/05_SCHOLARLY_ARTICLES/` - Peer-review-ready articles
- `/Lotus_Sutra/07_PUBLISHING_MATERIALS/` - Publisher queries and proposals

---

## Quick Command Reference

### Essential Workspace Commands

```bash
# Check project status and recent work
cat Lotus_Sutra/documentation/TODO_LIST_MASTER_TRACKER.md
cat Lotus_Sutra/documentation/DEVLOG.md

# Verify file encoding (critical for Sanskrit diacriticals)
file -i [filename]

# Search for text across all projects
grep -r "search_term" --include="*.txt" --include="*.md"

# Check recent git commits
git log --oneline -10

# View what changed in a file
git diff [filename]

# Revert accidental changes
git checkout [filename]           # Single file
git checkout .                    # Entire directory
```

### Project-Specific Commands

**Lotus Sutra** - Most common workflows:
```bash
# Find terminology usage
grep -n "≈öƒÅriputra" Lotus_Sutra/03_SCHOLARLY_TRANSLATION_2025/Scholarly_Chapters/*.txt

# Check encoding integrity
file -i Lotus_Sutra/03_SCHOLARLY_TRANSLATION_2025/Scholarly_Chapters/*.txt

# Audio production work
cd Lotus_Sutra/04_AUDIO_PRODUCTION/
```

**Surangama Sutra** - Getting started:
```bash
# View source text
cat "Surangama Sutra/Ê•ûÂö¥Á∂ì Surangama Sutra.txt"

# Check blues interpretation work
ls Surangama\ Sutra/01_BLUES_INTERPRETATION/
```

**Diamond Sutra** - Reference:
```bash
# View source text
cat "Diamond Sutra Project/ÈáëÂâõËà¨Ëã•Ê≥¢ÁæÖËúúÁ∂ì Diamond Sutra.txt"
```

---

## Important Notes for All Projects

### Character Encoding

- All translation files use **UTF-8 encoding**
- Sanskrit diacritical marks are critical: ≈õ (U+015B), ·πá (U+1E47), ≈´ (U+016B), ƒÅ (U+0101), ·πÉ (U+1E43)
- Always verify encoding after editing: `file -i [filename]` should show `charset=utf-8`
- Example proper names: ≈öƒÅriputra, MahƒÅkƒÅ≈õyapa, Ma√±ju≈õrƒ´, Avalokite≈õvara

### Terminology Consistency

- Buddhist terms should be consistently capitalized
- Standard Buddhist vocabulary: Dharma, Buddha, Bodhisattva, Tathagata, nirvƒÅ·πáa
- Check `/Lotus_Sutra/08_REFERENCE_MATERIALS/TERMINOLOGY_CORRECTIONS_SUMMARY.md` for current standards

### Version Control

- All projects use git for version control
- Commit frequently with clear messages
- Use git recovery procedures if needed (documented in `/Lotus_Sutra/CLAUDE.md`)

---

## Python Scripts (For Reference)

**Location**: `/scripts/`

Utility scripts for text processing (gender-inclusive revision):
- `revise_gender_inclusive.py` - Apply gender-inclusive language updates
- `apply_gender_inclusive_edits.py` - Batch apply gender revisions
- `complete_gender_edits.py` - Finalize gender revision edits

These scripts are for reference/historical purposes. Modern workflow uses direct editing with verification.

---

## Specialized Agents/Personas

The Lotus Sutra project includes 5 specialized agents for different types of work:

| Agent | Purpose | Use When |
|-------|---------|----------|
| **Dharma Audio Producer** | Audio script optimization for TTS | Preparing text for Gemini audio production |
| **Dr. Amara Chen-Rothenberg** | Scholarly article writing | Publishing peer-reviewed academic articles |
| **Miriam Steinberg** | Publishing industry evaluation | Evaluating commercial viability, negotiating with publishers |
| **Kaelen "Kai" Reed** | Classical Chinese poetic interpretation | Creating lyrical renderings of source texts |
| **HTML Code Master** | Web development and forms | Building interactive web features |

All agents are centralized in `/Lotus_Sutra/agents/` folder. See `/Lotus_Sutra/CLAUDE.md` for detailed descriptions and credentials.

---

## Getting Help

### For General Claude Code Questions

Use `/help` or visit https://github.com/anthropics/claude-code/issues

### For Project-Specific Questions

**Lotus Sutra**: See `/Lotus_Sutra/CLAUDE.md` sections on Troubleshooting & Recovery, Common Workflows, and Editing Guidelines.

**Other Sutras**: Similar structure to Lotus Sutra; apply same principles.

---

## Summary

This workspace is organized around **Buddhist sutra translation with professional audio production and academic publishing**. The primary focus is the Lotus Sutra with comprehensive translation, analysis, and production materials. All work follows principles of fidelity to source material, preservation of sacred register, and protection of careful scholarship.

**Start here**: `/Lotus_Sutra/CLAUDE.md` contains the detailed guidance you'll need for most work in this repository.

---

## Additional Resources

### Getting Help
- **Claude Code**: Use `/help` or visit https://github.com/anthropics/claude-code/issues
- **Lotus Sutra**: See `/Lotus_Sutra/CLAUDE.md` for detailed troubleshooting & recovery procedures
- **Other Projects**: Each project has a CLAUDE.md with project-specific guidance

### When You're Lost
1. Check `Lotus_Sutra/documentation/TODO_LIST_MASTER_TRACKER.md` - What's currently being worked on?
2. Check `Lotus_Sutra/documentation/DEVLOG.md` - What was done recently?
3. Run `git log --oneline -20` - See recent commits with descriptions
4. Read the appropriate project CLAUDE.md file - Each has navigation guides

---

**Last Updated**: November 26, 2025
**Created by**: Claude Code
**Maintained by**: Claude Code
**Repository**: Buddhist Sutra Translation Workspace
**Status**: Enhanced with comprehensive multi-project guidance
